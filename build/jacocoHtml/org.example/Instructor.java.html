<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Instructor.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">miniProj_onINTELLIJ</a> &gt; <a href="index.source.html" class="el_package">org.example</a> &gt; <span class="el_source">Instructor.java</span></div><h1>Instructor.java</h1><pre class="source lang-java linenums">package org.example;

import com.opencsv.CSVReader;
import com.opencsv.exceptions.CsvValidationException;
import de.vandermeer.asciitable.*;
import de.vandermeer.asciithemes.a7.*;

import java.io.FileReader;
import java.io.IOException;
import java.sql.Connection;
import java.sql.*;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

class Instructor extends Person{
    private String instID;
    private String password;

    private void setInstID(String instID){
<span class="fc" id="L22">        this.instID = instID;</span>
<span class="fc" id="L23">    }</span>
    private void setPassword(String password){
<span class="fc" id="L25">        this.password=password;</span>
<span class="fc" id="L26">    }</span>
<span class="fc" id="L27">    public Instructor(String instID,String password) {</span>
<span class="fc" id="L28">        setInstID(instID);</span>
<span class="fc" id="L29">        setPassword(password);</span>
<span class="fc" id="L30">    }</span>
    @Override
    public String login(Connection connection) throws SQLException {
<span class="fc" id="L33">        String toRettt= &quot;&quot;;</span>
<span class="fc" id="L34">        String sql = &quot;SELECT * FROM instructors WHERE instructorid = ? AND password = ?&quot;;</span>
<span class="fc" id="L35">        PreparedStatement pstmt = connection.prepareStatement(sql);</span>
<span class="fc" id="L36">        pstmt.setString(1, this.instID);</span>
<span class="fc" id="L37">        pstmt.setString(2, this.password);</span>

<span class="fc" id="L39">        ResultSet rs = pstmt.executeQuery();</span>
<span class="fc bfc" id="L40" title="All 2 branches covered.">        if (rs.next()) {</span>
<span class="fc" id="L41">            String name = rs.getString(&quot;instructorname&quot;);</span>
<span class="fc" id="L42">            String contactNumber = rs.getString(&quot;contactno&quot;);</span>
<span class="fc" id="L43">            System.out.println(&quot;Login successful! Welcome &quot; + name + &quot;!&quot;);</span>
<span class="fc" id="L44">            toRettt= rs.getString(&quot;instructorid&quot;);</span>
<span class="fc" id="L45">        } else {</span>
<span class="fc" id="L46">            toRettt= &quot;q&quot;;</span>
        }
<span class="fc" id="L48">        rs.close();</span>
<span class="fc" id="L49">        pstmt.close();</span>
<span class="fc" id="L50">        return toRettt;</span>
    }

    public void offerCourse(Connection connection, Scanner scanner) throws SQLException {
<span class="fc" id="L54">        String choice = &quot;&quot;;</span>

        do{
<span class="fc" id="L57">            System.out.println(&quot;Select 1. To view the course catalog 2. To offer a course 3. View your offered courses for this semester 4. Deregister offered course 5. To go back dashboard&quot;);</span>
<span class="fc" id="L58">            choice = scanner.next();</span>
<span class="fc bfc" id="L59" title="All 2 branches covered.">            if(choice.equals(&quot;1&quot;)) {</span>
<span class="fc" id="L60">                String query = &quot;SELECT courseid, coursename, ltps, creds, csb, mcb, eeb, chb, mmb, ceb, meb FROM coursecatalog&quot;;</span>
<span class="fc" id="L61">                Statement stmt = connection.createStatement();</span>
<span class="fc" id="L62">                ResultSet rs = stmt.executeQuery(query);</span>

<span class="fc" id="L64">                AsciiTable at = new AsciiTable();</span>
<span class="fc" id="L65">                at.getContext().setGrid(A7_Grids.minusBarPlusEquals());</span>

<span class="fc" id="L67">                at.addRule();</span>
<span class="fc" id="L68">                at.addRow(&quot;Course ID&quot;, &quot;Course Name&quot;, &quot;LTPs&quot;, &quot;Credits&quot;, &quot;CSB&quot;, &quot;MCB&quot;, &quot;EEB&quot;, &quot;CHB&quot;, &quot;MMB&quot;, &quot;CEB&quot;, &quot;MEB&quot;);</span>
<span class="fc" id="L69">                at.addRule();</span>
<span class="fc bfc" id="L70" title="All 2 branches covered.">                while (rs.next()) {</span>
<span class="fc" id="L71">                    at.addRow(rs.getString(&quot;courseid&quot;),</span>
<span class="fc" id="L72">                            rs.getString(&quot;coursename&quot;),</span>
<span class="fc" id="L73">                            rs.getString(&quot;ltps&quot;),</span>
<span class="fc" id="L74">                            rs.getInt(&quot;creds&quot;),</span>
<span class="fc" id="L75">                            rs.getString(&quot;csb&quot;),</span>
<span class="fc" id="L76">                            rs.getString(&quot;mcb&quot;),</span>
<span class="fc" id="L77">                            rs.getString(&quot;eeb&quot;),</span>
<span class="fc" id="L78">                            rs.getString(&quot;chb&quot;),</span>
<span class="fc" id="L79">                            rs.getString(&quot;mmb&quot;),</span>
<span class="fc" id="L80">                            rs.getString(&quot;ceb&quot;),</span>
<span class="fc" id="L81">                            rs.getString(&quot;meb&quot;));</span>
<span class="fc" id="L82">                    at.addRule();</span>
                }

<span class="fc" id="L85">                at.setPaddingLeftRight(1);</span>
<span class="fc" id="L86">                at.getRenderer().setCWC(new CWC_LongestWord());</span>
<span class="fc" id="L87">                System.out.println(at.render());</span>

<span class="fc" id="L89">            }</span>
<span class="fc bfc" id="L90" title="All 2 branches covered.">            else if(choice.equals(&quot;2&quot;)) {</span>
                String cCode;
                while(1==1){
<span class="fc" id="L93">                    System.out.println(&quot;Enter the course code or enter q to return to dashboard: &quot;);        //to add course code and department check !!!!</span>
<span class="fc" id="L94">                    cCode = scanner.next();</span>
<span class="fc bfc" id="L95" title="All 2 branches covered.">                    if(cCode.equals(&quot;q&quot;)){break;}</span>

<span class="fc" id="L97">                    PreparedStatement pstmt = connection.prepareStatement(&quot;Select courseid, periodoffered from coursesoffered where courseid =?&quot;);</span>
<span class="fc" id="L98">                    pstmt.setString(1,cCode);</span>
<span class="fc" id="L99">                    ResultSet rs = pstmt.executeQuery();</span>
<span class="pc bpc" id="L100" title="1 of 4 branches missed.">                    if(rs.next() &amp;&amp; rs.getString(&quot;periodoffered&quot;).equals(Utilities.yearTermFinder(connection))){</span>
<span class="fc" id="L101">                        System.out.println(&quot;Already offered course! Try again.&quot;);</span>
<span class="fc" id="L102">                        continue;</span>
                    }

<span class="fc" id="L105">                    pstmt = connection.prepareStatement(&quot;Select courseid from coursecatalog where courseid =?&quot;);</span>
<span class="fc" id="L106">                    pstmt.setString(1,cCode);</span>
<span class="fc" id="L107">                    rs = pstmt.executeQuery();</span>
<span class="fc bfc" id="L108" title="All 2 branches covered.">                    if(!rs.next()){</span>
<span class="fc" id="L109">                        System.out.println(&quot;Course does not exist in the catalog! Try again.&quot;);</span>
<span class="fc" id="L110">                        continue;</span>
                    }
<span class="fc" id="L112">                    pstmt.close();</span>
<span class="fc" id="L113">                    break;</span>

                }
<span class="fc bfc" id="L116" title="All 2 branches covered.">                if(cCode.equals(&quot;q&quot;)){break;}</span>

//                System.out.println(&quot;Set a minimum CGPA requirement: &quot;);
//                int minCGPA = scanner.nextInt();

<span class="fc" id="L121">                PreparedStatement pstmt = connection.prepareStatement(&quot;INSERT INTO coursesoffered (courseid, instructorId, mincgpa, periodoffered) VALUES (?, ?, ?, ?)&quot;);</span>
<span class="fc" id="L122">                pstmt.setString(1,cCode);</span>
<span class="fc" id="L123">                pstmt.setString(2,this.instID);</span>
<span class="fc" id="L124">                pstmt.setNull(3, Types.INTEGER );</span>
<span class="fc" id="L125">                pstmt.setString(4, Utilities.yearTermFinder(connection));</span>
<span class="fc" id="L126">                pstmt.execute();</span>
<span class="fc" id="L127">                pstmt.close();</span>
<span class="fc" id="L128">                System.out.println(&quot;Offered successfully&quot;);</span>
<span class="fc" id="L129">            }</span>
<span class="fc bfc" id="L130" title="All 2 branches covered.">            else if(choice.equals(&quot;3&quot;)){</span>
<span class="fc" id="L131">                String query = &quot;SELECT * from coursesoffered where periodoffered = ? and instructorid=?&quot;;</span>
<span class="fc" id="L132">                PreparedStatement pstmt = connection.prepareStatement(query);</span>
<span class="fc" id="L133">                pstmt.setString(1,Utilities.yearTermFinder(connection));</span>
<span class="fc" id="L134">                pstmt.setString(2,this.instID);</span>
<span class="fc" id="L135">                ResultSet rs = pstmt.executeQuery();</span>

<span class="fc" id="L137">                AsciiTable at = new AsciiTable();</span>
<span class="fc" id="L138">                at.getContext().setGrid(A7_Grids.minusBarPlusEquals());</span>
<span class="fc" id="L139">                at.addRule();</span>
<span class="fc" id="L140">                at.addRow(&quot;Course ID&quot;, &quot;Instructor ID&quot;, &quot;CGPA cutoff&quot;);</span>
<span class="fc" id="L141">                at.addRule();</span>
<span class="fc bfc" id="L142" title="All 2 branches covered.">                while (rs.next()) {</span>
<span class="fc" id="L143">                    at.addRow(rs.getString(&quot;courseid&quot;),</span>
<span class="fc" id="L144">                            rs.getString(&quot;instructorid&quot;),</span>
<span class="fc" id="L145">                            rs.getInt(&quot;minCGPA&quot;));</span>
<span class="fc" id="L146">                    at.addRule();</span>
                }
<span class="fc" id="L148">                at.setPaddingLeftRight(1);</span>
<span class="fc" id="L149">                at.getRenderer().setCWC(new CWC_LongestWord());</span>
<span class="fc" id="L150">                System.out.println(at.render());</span>
<span class="fc" id="L151">                pstmt.close();</span>
<span class="fc" id="L152">            }</span>

<span class="fc bfc" id="L154" title="All 2 branches covered.">            else if(choice.equals(&quot;4&quot;)){</span>
<span class="fc" id="L155">                System.out.println(&quot;Enter the course code: &quot;);</span>
<span class="fc" id="L156">                String removalCourse = scanner.next();</span>
<span class="fc" id="L157">                PreparedStatement pstmt = connection.prepareStatement(&quot;Delete from coursesoffered where courseid=? and instructorid=? and periodoffered=?&quot;);</span>
<span class="fc" id="L158">                pstmt.setString(1,removalCourse);</span>
<span class="fc" id="L159">                pstmt.setString(2,this.instID);</span>
<span class="fc" id="L160">                pstmt.setString(3,Utilities.yearTermFinder(connection));</span>

<span class="fc" id="L162">                int rowDel = pstmt.executeUpdate();</span>
<span class="fc bfc" id="L163" title="All 2 branches covered.">                if(rowDel&gt;0){System.out.println(&quot;Deregistered successfully&quot;);}</span>
<span class="fc" id="L164">                else{System.out.println(&quot;Could not deregister this course. Check for typo or existence in this semester.&quot;);}</span>
<span class="fc" id="L165">                pstmt.close();</span>
<span class="fc" id="L166">            }</span>

<span class="fc bfc" id="L168" title="All 2 branches covered.">            else if(choice.equals(&quot;5&quot;)){</span>
<span class="fc" id="L169">                break;</span>
            }

<span class="fc" id="L172">            else {System.out.println(&quot;Invalid Input: &quot;);}</span>
<span class="pc bpc" id="L173" title="1 of 2 branches missed.">        }while(!choice.equals(&quot;5&quot;));</span>
<span class="fc" id="L174">    }</span>
    public void changeinfo(Connection connection,Scanner scanner) throws SQLException {
<span class="fc" id="L176">        String choice = &quot;&quot;;</span>

        do{
<span class="fc" id="L179">            System.out.println(&quot;Select 1. To change contact number 2. To change password. 3. To go back dashboard&quot;);</span>
<span class="fc" id="L180">            choice = scanner.next();</span>
<span class="fc bfc" id="L181" title="All 2 branches covered.">            if(choice.equals(&quot;1&quot;)) {</span>
                String newPassword;
<span class="fc" id="L183">                System.out.println(&quot;Enter the new contact number: &quot;);</span>
<span class="fc" id="L184">                newPassword = scanner.next();</span>
<span class="fc" id="L185">                System.out.println(&quot;ok&quot;);</span>
<span class="fc" id="L186">                String query = &quot;UPDATE instructors SET contactno = ? WHERE instructorid = ?&quot;;</span>
<span class="fc" id="L187">                PreparedStatement pstmt = connection.prepareStatement(query);</span>
<span class="fc" id="L188">                pstmt.setString(1, newPassword);</span>
<span class="fc" id="L189">                pstmt.setString(2, this.instID);</span>
<span class="fc" id="L190">                pstmt.executeUpdate();</span>
<span class="fc" id="L191">                pstmt.close();</span>

<span class="fc" id="L193">            }</span>
<span class="fc bfc" id="L194" title="All 2 branches covered.">            else if(choice.equals(&quot;2&quot;)) {</span>
                String newPassword;
<span class="fc" id="L196">                System.out.println(&quot;Choose your new password: &quot;);</span>
<span class="fc" id="L197">                newPassword = scanner.next();</span>
<span class="fc" id="L198">                String query = &quot;UPDATE instructors SET password = ? WHERE instructorid = ?&quot;;</span>
<span class="fc" id="L199">                PreparedStatement pstmt = connection.prepareStatement(query);</span>
<span class="fc" id="L200">                pstmt.setString(1, newPassword);</span>
<span class="fc" id="L201">                pstmt.setString(2, this.instID);</span>
<span class="fc" id="L202">                pstmt.executeUpdate();</span>
<span class="fc" id="L203">                pstmt.close();</span>
<span class="fc" id="L204">            }</span>
<span class="pc bpc" id="L205" title="1 of 2 branches missed.">            else if(choice.equals(&quot;3&quot;)){</span>
<span class="fc" id="L206">                break;</span>
            }
<span class="nc" id="L208">            else {System.out.println(&quot;Invalid Input: &quot;);}</span>
<span class="pc bpc" id="L209" title="1 of 2 branches missed.">        }while(!choice.equals(&quot;3&quot;));</span>

<span class="fc" id="L211">    }</span>

    public void approveRequests(Connection connection, Scanner scanner) throws SQLException {
<span class="fc" id="L214">        String choice = &quot;&quot;;</span>
<span class="fc bfc" id="L215" title="All 2 branches covered.">        while(!choice.equals(&quot;4&quot;)){</span>
<span class="fc" id="L216">            System.out.println(&quot;Select 1. To view requests 2. To approve all pending 3. Approve invidiually 4. Back to Dashboard&quot;);</span>
<span class="fc" id="L217">            choice = scanner.next();</span>
            PreparedStatement pstmt;

<span class="fc bfc" id="L220" title="All 3 branches covered.">            switch (choice) {</span>
                case &quot;1&quot;:
<span class="fc" id="L222">                    AsciiTable at = new AsciiTable();</span>
<span class="fc" id="L223">                    at.getContext().setGrid(A7_Grids.minusBarPlusEquals());</span>

<span class="fc" id="L225">                    at.addRule();</span>
<span class="fc" id="L226">                    at.addRow(&quot;Course ID&quot;, &quot;Student ID&quot;);</span>
<span class="fc" id="L227">                    at.addRule();</span>
<span class="fc" id="L228">                    String query = &quot;SELECT * FROM coursesapproval WHERE instructorid = ?&quot;;</span>
<span class="fc" id="L229">                    pstmt = connection.prepareStatement(query);</span>
<span class="fc" id="L230">                    pstmt.setString(1, this.instID);</span>
<span class="fc" id="L231">                    ResultSet rs = pstmt.executeQuery();</span>


<span class="fc bfc" id="L234" title="All 2 branches covered.">                    while (rs.next()) {</span>
<span class="fc" id="L235">                        at.addRow(rs.getString(&quot;courseid&quot;),</span>
<span class="fc" id="L236">                                rs.getString(&quot;studentid&quot;));</span>
<span class="fc" id="L237">                        at.addRule();</span>
                    }

<span class="fc" id="L240">                    at.setPaddingLeftRight(1);</span>
<span class="fc" id="L241">                    at.getRenderer().setCWC(new CWC_LongestWord());</span>
<span class="fc" id="L242">                    System.out.println(at.render());</span>
<span class="fc" id="L243">                    pstmt.close();</span>
<span class="fc" id="L244">                    break;</span>
                case &quot;2&quot;:
<span class="fc" id="L246">                    query = &quot;SELECT * FROM coursesapproval WHERE instructorid = ?&quot;;</span>
<span class="fc" id="L247">                    pstmt = connection.prepareStatement(query);</span>
<span class="fc" id="L248">                    pstmt.setString(1, this.instID);</span>
<span class="fc" id="L249">                    rs = pstmt.executeQuery();</span>

<span class="fc bfc" id="L251" title="All 2 branches covered.">                    while(rs.next()){</span>
<span class="fc" id="L252">                        PreparedStatement addToCourseTaken = connection.prepareStatement(&quot;Insert into coursestaken(courseid , studentid  ,periodtaken , grade ,type) values(?,?,?,?,?)&quot;);</span>
<span class="fc" id="L253">                        addToCourseTaken.setString(1,rs.getString(&quot;courseid&quot;));</span>
<span class="fc" id="L254">                        addToCourseTaken.setString(2,rs.getString(&quot;studentid&quot;));</span>
<span class="fc" id="L255">                        addToCourseTaken.setString(3, Utilities.yearTermFinder(connection));</span>
<span class="fc" id="L256">                        addToCourseTaken.setNull(4, Types.VARCHAR);</span>

<span class="fc" id="L258">                        String courseType = &quot;&quot;;</span>
<span class="fc" id="L259">                        String sql = String.format(&quot;select %s from courseCatalog where TRIM(courseid) = TRIM(?)&quot;, rs.getString(&quot;studentid&quot;).substring(4,7));</span>
<span class="fc" id="L260">                        PreparedStatement findType = connection.prepareStatement(sql);</span>
<span class="fc" id="L261">                        findType.setString(1,rs.getString(&quot;courseid&quot;));</span>
<span class="fc" id="L262">                        ResultSet type = findType.executeQuery();</span>
<span class="pc bpc" id="L263" title="1 of 2 branches missed.">                        if(type.next()){courseType = type.getString(rs.getString(&quot;studentid&quot;).substring(4,7));}</span>

<span class="fc" id="L265">                        addToCourseTaken.setString(5,courseType);</span>
<span class="fc" id="L266">                        addToCourseTaken.execute();</span>

<span class="fc" id="L268">                        addToCourseTaken = connection.prepareStatement(&quot;Delete from coursesapproval where courseid=? and studentid=?&quot;);</span>
<span class="fc" id="L269">                        addToCourseTaken.setString(1,rs.getString(&quot;courseid&quot;));</span>
<span class="fc" id="L270">                        addToCourseTaken.setString(2,rs.getString(&quot;studentid&quot;));</span>
<span class="fc" id="L271">                        addToCourseTaken.execute();</span>

<span class="fc" id="L273">                        addToCourseTaken.close();</span>

<span class="fc" id="L275">                    }</span>
<span class="fc" id="L276">                    pstmt.close();</span>
<span class="fc" id="L277">                    break;</span>

                case &quot;4&quot;:
                    break;
<span class="fc" id="L281">            }</span>
        }
<span class="fc" id="L283">    }</span>

    public void viewGrades(Connection connection,Scanner scanner) throws SQLException {
<span class="fc" id="L286">        System.out.println(&quot;Enter the ID of the student whose grades you want to view:&quot;);</span>
<span class="fc" id="L287">        String studentid = scanner.next();</span>
<span class="fc" id="L288">        student.viewGrades(connection,studentid,false);</span>
<span class="fc" id="L289">    }</span>

    public void uploadGrades(Scanner scanner, Connection connection) throws IOException, CsvValidationException, SQLException {
<span class="fc" id="L292">        System.out.println(&quot;Enter the file containing grades for this semester or q to leave: &quot;);</span>
<span class="fc" id="L293">        String fileName = scanner.next();</span>
<span class="fc bfc" id="L294" title="All 2 branches covered.">        if (fileName.equals(&quot;q&quot;)) {</span>
<span class="fc" id="L295">            return;</span>
        }
        String[] nextLine;
<span class="fc" id="L298">        CSVReader reader = new CSVReader(new FileReader(&quot;./src/main/java/org/example/dataFiles/gradeInfo/&quot;+ fileName));</span>
<span class="fc" id="L299">        int i= 0;</span>
<span class="fc bfc" id="L300" title="All 2 branches covered.">        while ((nextLine = reader.readNext()) != null) {</span>
<span class="fc bfc" id="L301" title="All 2 branches covered.">            if(i==0){i++; continue;}</span>

<span class="fc" id="L303">            String courseid = nextLine[0];</span>
<span class="fc" id="L304">            String studentid = nextLine[1];</span>
<span class="fc" id="L305">            String grade = nextLine[2];</span>

<span class="fc" id="L307">            PreparedStatement isOffered = connection.prepareStatement(&quot;select * from coursesoffered where courseid=? and instructorid=? and periodoffered=?&quot;);</span>
<span class="fc" id="L308">            isOffered.setString(1, courseid.replaceAll(&quot;\\s&quot;, &quot;&quot;));</span>
<span class="fc" id="L309">            isOffered.setString(2, this.instID);</span>
<span class="fc" id="L310">            isOffered.setString(3,Utilities.yearTermFinder(connection));</span>
<span class="fc" id="L311">            ResultSet rs = isOffered.executeQuery();</span>
<span class="pc bpc" id="L312" title="1 of 2 branches missed.">            if(rs.next()){</span>
<span class="fc" id="L313">                PreparedStatement updateGrade = connection.prepareStatement(&quot;UPDATE coursestaken SET grade = ? WHERE courseid = ? AND  periodtaken=? and studentid=?&quot;);</span>
<span class="fc" id="L314">                updateGrade.setString(1,grade);</span>
<span class="fc" id="L315">                updateGrade.setString(2,courseid);</span>
<span class="fc" id="L316">                updateGrade.setString(3,Utilities.yearTermFinder(connection));</span>
<span class="fc" id="L317">                updateGrade.setString(4,studentid);</span>
<span class="fc" id="L318">                updateGrade.execute();</span>
<span class="fc" id="L319">                updateGrade.close();</span>
<span class="fc" id="L320">            }</span>
            else{
<span class="nc" id="L322">                System.out.println(&quot;Course was not offered by you this semester, typo?&quot;);</span>
<span class="nc" id="L323">                return;</span>
            }
<span class="fc" id="L325">            isOffered.close();</span>
<span class="fc" id="L326">        }</span>
<span class="fc" id="L327">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>